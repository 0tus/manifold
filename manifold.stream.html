<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>manifold.stream documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Manifold 0.1.4 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>manifold</span></div></div></li><li class="depth-2 branch"><a href="manifold.bus.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bus</span></div></a></li><li class="depth-2 branch"><a href="manifold.deferred.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deferred</span></div></a></li><li class="depth-2 branch"><a href="manifold.executor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>executor</span></div></a></li><li class="depth-2 branch current"><a href="manifold.stream.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stream</span></div></a></li><li class="depth-2"><a href="manifold.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="manifold.stream.html#var--.3EBufferedStream"><div class="inner"><span>-&gt;BufferedStream</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var--.3Esink"><div class="inner"><span>-&gt;sink</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var--.3Esource"><div class="inner"><span>-&gt;source</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-batch"><div class="inner"><span>batch</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-buffer"><div class="inner"><span>buffer</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-buffered-stream"><div class="inner"><span>buffered-stream</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-close.21"><div class="inner"><span>close!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-closed.3F"><div class="inner"><span>closed?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-concat"><div class="inner"><span>concat</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-connect"><div class="inner"><span>connect</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-connect-via"><div class="inner"><span>connect-via</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-consume"><div class="inner"><span>consume</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-consume-async"><div class="inner"><span>consume-async</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-description"><div class="inner"><span>description</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-downstream"><div class="inner"><span>downstream</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-drained.3F"><div class="inner"><span>drained?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-filter"><div class="inner"><span>filter</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-lazily-partition-by"><div class="inner"><span>lazily-partition-by</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-map"><div class="inner"><span>map</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-mapcat"><div class="inner"><span>mapcat</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-on-closed"><div class="inner"><span>on-closed</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-on-drained"><div class="inner"><span>on-drained</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-onto"><div class="inner"><span>onto</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-periodically"><div class="inner"><span>periodically</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-put.21"><div class="inner"><span>put!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-put-all.21"><div class="inner"><span>put-all!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-realize-each"><div class="inner"><span>realize-each</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-reduce"><div class="inner"><span>reduce</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-reductions"><div class="inner"><span>reductions</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-sink-only"><div class="inner"><span>sink-only</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-sink.3F"><div class="inner"><span>sink?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-sinkable.3F"><div class="inner"><span>sinkable?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-source-only"><div class="inner"><span>source-only</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-source.3F"><div class="inner"><span>source?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-sourceable.3F"><div class="inner"><span>sourceable?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-splice"><div class="inner"><span>splice</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-stream"><div class="inner"><span>stream</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-stream*"><div class="inner"><span>stream*</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-stream-.3Eseq"><div class="inner"><span>stream-&gt;seq</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-stream.3F"><div class="inner"><span>stream?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-synchronous.3F"><div class="inner"><span>synchronous?</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-take.21"><div class="inner"><span>take!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-throttle"><div class="inner"><span>throttle</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-transform"><div class="inner"><span>transform</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-try-put.21"><div class="inner"><span>try-put!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-try-take.21"><div class="inner"><span>try-take!</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-weak-handle"><div class="inner"><span>weak-handle</span></div></a></li><li class="depth-1"><a href="manifold.stream.html#var-zip"><div class="inner"><span>zip</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">manifold.stream</h2><div class="doc"><div class="markdown"><p>Methods for creating, transforming, and interacting with asynchronous streams of values.</p></div></div><div class="public anchor" id="var--.3EBufferedStream"><h3>-&gt;BufferedStream</h3><div class="usage"><code>(-&gt;BufferedStream buf limit metric description buffer-size last-put buf+ handle mta)</code></div><div class="doc"><div class="markdown"><p>Positional factory function for class manifold.stream.BufferedStream.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L787">view source</a></div></div><div class="public anchor" id="var--.3Esink"><h3>-&gt;sink</h3><div class="usage"><code>(-&gt;sink x)</code><code>(-&gt;sink x default-val)</code></div><div class="doc"><div class="markdown"><p>Converts, if possible, the object to a Manifold sink, or <code>default-val</code> if it cannot. If no default value is given, an <code>IllegalArgumentException</code> is thrown.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L62">view source</a></div></div><div class="public anchor" id="var--.3Esource"><h3>-&gt;source</h3><div class="usage"><code>(-&gt;source x)</code><code>(-&gt;source x default-val)</code></div><div class="doc"><div class="markdown"><p>Converts, if possible, the object to a Manifold source, or <code>default-val</code> if it cannot. If no default value is given, an <code>IllegalArgumentException</code> is thrown.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L78">view source</a></div></div><div class="public anchor" id="var-batch"><h3>batch</h3><div class="usage"><code>(batch batch-size s)</code><code>(batch max-size max-latency s)</code><code>(batch metric max-size max-latency s)</code></div><div class="doc"><div class="markdown"><p>Batches messages, either into groups of fixed size, or according to upper bounds on size and latency, in milliseconds. By default, each message is of size <code>1</code>, but a custom <code>metric</code> function that returns the size of each message may be defined.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L948">view source</a></div></div><div class="public anchor" id="var-buffer"><h3>buffer</h3><div class="usage"><code>(buffer limit s)</code><code>(buffer metric limit s)</code></div><div class="doc"><div class="markdown"><p>Takes a stream, and returns a stream which is a buffered view of that stream. The buffer size may either be measured in messages, or if a <code>metric</code> is defined, by the sum of <code>metric</code> mapped over all messages currently buffered.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L935">view source</a></div></div><div class="public anchor" id="var-buffered-stream"><h3>buffered-stream</h3><div class="usage"><code>(buffered-stream buffer-size)</code><code>(buffered-stream metric limit)</code><code>(buffered-stream metric limit description)</code></div><div class="doc"><div class="markdown"><p>A stream which will buffer at most <code>limit</code> data, where the size of each message is defined by <code>(metric message)</code>.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L901">view source</a></div></div><div class="public anchor" id="var-close.21"><h3>close!</h3><div class="usage"><code>(close! sink)</code></div><div class="doc"><div class="markdown"><p>Closes a source or sink, so that it can&rsquo;t emit or accept any more messages.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L199">view source</a></div></div><div class="public anchor" id="var-closed.3F"><h3>closed?</h3><div class="usage"><code>(closed? sink)</code></div><div class="doc"><div class="markdown"><p>Returns true if the event sink is closed.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L204">view source</a></div></div><div class="public anchor" id="var-concat"><h3>concat</h3><div class="usage"><code>(concat s)</code></div><div class="doc"><div class="markdown"><p>Takes a stream of streams, and flattens it into a single stream.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L753">view source</a></div></div><div class="public anchor" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect source sink)</code><code>(connect source sink {:keys [upstream? downstream? timeout description], :or {upstream? false, downstream? true}})</code></div><div class="doc"><div class="markdown"><p>Connects a source to a sink, propagating all messages from the former into the latter.</p><p>Optionally takes a map of parameters:</p>
<table>
  <tbody>
    <tr>
      <td align="left"><code>upstream?</code> </td>
      <td align="left">if closing the sink should always close the source, even if there are other sinks downstream of the source. Defaults to <code>false</code>. Note that if the sink is the only thing downstream of the source, the source will always be closed, unless it is permanent.</td>
    </tr>
    <tr>
      <td align="left"><code>downstream?</code> </td>
      <td align="left">if closing the source will close the sink. Defaults to <code>true</code>.</td>
    </tr>
    <tr>
      <td align="left"><code>timeout</code> </td>
      <td align="left">if defined, the maximum time, in milliseconds, that will be spent trying to put a message into the sink before closing it. Useful when there are multiple sinks downstream of a source, and you want to avoid a single backed up sink from blocking all the others.</td>
    </tr>
    <tr>
      <td align="left"><code>description</code> </td>
      <td align="left">describes the connection, useful for traversing the stream topology via <code>downstream</code>.</td>
    </tr>
  </tbody>
</table></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L300">view source</a></div></div><div class="public anchor" id="var-connect-via"><h3>connect-via</h3><div class="usage"><code>(connect-via src callback dst)</code><code>(connect-via src callback dst options)</code></div><div class="doc"><div class="markdown"><p>Feeds all messages from <code>src</code> into <code>callback</code>, with the understanding that they will eventually be propagated into <code>dst</code> in some form. The return value of <code>callback</code> should be a deferred yielding either <code>true</code> or <code>false</code>. When <code>false</code>, the downstream sink is assumed to be closed, and the connection is severed.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L487">view source</a></div></div><div class="public anchor" id="var-consume"><h3>consume</h3><div class="usage"><code>(consume callback source)</code></div><div class="doc"><div class="markdown"><p>Feeds all messages from <code>source</code> into <code>callback</code>.</p><p>Messages will be processed as quickly as the callback can be executed.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L472">view source</a></div></div><div class="public anchor" id="var-consume-async"><h3>consume-async</h3><div class="usage"><code>(consume-async callback source)</code></div><div class="doc"><div class="markdown"><p>Feeds all messages from <code>source</code> into <code>callback</code>, which must return a deferred yielding <code>true</code> or <code>false</code>. If the returned value yields <code>false</code>, the consumption will be cancelled.</p><p>Messages will be processed only as quickly as the deferred values are realized.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L479">view source</a></div></div><div class="public anchor" id="var-description"><h3>description</h3><div class="usage"><code>(description x)</code></div><div class="doc"><div class="markdown"><p>Returns a description of the stream.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L176">view source</a></div></div><div class="public anchor" id="var-downstream"><h3>downstream</h3><div class="usage"><code>(downstream x)</code></div><div class="doc"><div class="markdown"><p>Returns all sinks downstream of the given source as a sequence of 2-tuples, with the first element containing the connection&rsquo;s description, and the second element containing the sink.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L181">view source</a></div></div><div class="public anchor" id="var-drained.3F"><h3>drained?</h3><div class="usage"><code>(drained? source)</code></div><div class="doc"><div class="markdown"><p>Returns true if the event source is drained.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L214">view source</a></div></div><div class="public anchor" id="var-filter"><h3>filter</h3><div class="usage"><code>(filter pred s)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>filter</code>, but for streams instead of sequences.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L633">view source</a></div></div><div class="public anchor" id="var-lazily-partition-by"><h3>lazily-partition-by</h3><div class="usage"><code>(lazily-partition-by f s)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>partition-by</code>, but returns a stream of streams. This means that if a sub-stream is not completely consumed, the next sub-stream will never be emitted.</p><p>Use with caution. If you&rsquo;re not totally sure you want a stream of streams, use <code>(transform (partition-by f))</code> instead.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L714">view source</a></div></div><div class="public anchor" id="var-map"><h3>map</h3><div class="usage"><code>(map f s)</code><code>(map f s &amp; rest)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>map</code>, but for streams instead of sequences.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L574">view source</a></div></div><div class="public anchor" id="var-mapcat"><h3>mapcat</h3><div class="usage"><code>(mapcat f s)</code><code>(mapcat f s &amp; rest)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>mapcat</code>, but for streams instead of sequences.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L696">view source</a></div></div><div class="public anchor" id="var-on-closed"><h3>on-closed</h3><div class="usage"><code>(on-closed sink callback)</code></div><div class="doc"><div class="markdown"><p>Registers a no-arg callback which is invoked when the sink is closed.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L209">view source</a></div></div><div class="public anchor" id="var-on-drained"><h3>on-drained</h3><div class="usage"><code>(on-drained source callback)</code></div><div class="doc"><div class="markdown"><p>Registers a no-arg callback which is invoked when the source is drained.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L219">view source</a></div></div><div class="public anchor" id="var-onto"><h3>onto</h3><div class="usage"><code>(onto executor s)</code></div><div class="doc"><div class="markdown"><p>Returns an identical stream whose deferred callbacks will be executed on <code>executor</code>.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L153">view source</a></div></div><div class="public anchor" id="var-periodically"><h3>periodically</h3><div class="usage"><code>(periodically period initial-delay f)</code><code>(periodically period f)</code></div><div class="doc"><div class="markdown"><p>Creates a stream which emits the result of invoking <code>(f)</code> every <code>period</code> milliseconds.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L553">view source</a></div></div><div class="public anchor" id="var-put.21"><h3>put!</h3><div class="usage"><code>(put! sink x)</code></div><div class="doc"><div class="markdown"><p>Puts a value into a sink, returning a deferred that yields <code>true</code> if it succeeds, and <code>false</code> if it fails. Guaranteed to be non-blocking.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L224">view source</a></div></div><div class="public anchor" id="var-put-all.21"><h3>put-all!</h3><div class="usage"><code>(put-all! sink msgs)</code></div><div class="doc"><div class="markdown"><p>Puts all values into the sink, returning a deferred that yields <code>true</code> if all puts are successful, or <code>false</code> otherwise. If the sink provides backpressure, will pause. Guaranteed to be non-blocking.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L232">view source</a></div></div><div class="public anchor" id="var-realize-each"><h3>realize-each</h3><div class="usage"><code>(realize-each s)</code></div><div class="doc"><div class="markdown"><p>Takes a stream of potentially deferred values, and returns a stream of realized values.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L588">view source</a></div></div><div class="public anchor" id="var-reduce"><h3>reduce</h3><div class="usage"><code>(reduce f s)</code><code>(reduce f initial-value s)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>reduce</code>, but returns a deferred representing the return value.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L677">view source</a></div></div><div class="public anchor" id="var-reductions"><h3>reductions</h3><div class="usage"><code>(reductions f s)</code><code>(reductions f initial-value s)</code></div><div class="doc"><div class="markdown"><p>Equivalent to Clojure&rsquo;s <code>reductions</code>, but for streams instead of sequences.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L646">view source</a></div></div><div class="public anchor" id="var-sink-only"><h3>sink-only</h3><div class="usage"><code>(sink-only s)</code></div><div class="doc"><div class="markdown"><p>Returns a view of the stream which is only a sink.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L148">view source</a></div></div><div class="public anchor" id="var-sink.3F"><h3>sink?</h3><div class="usage"><code>(sink? x)</code></div><div class="doc"><div class="markdown"><p>Returns true if the object is a Manifold sink.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L171">view source</a></div></div><div class="public anchor" id="var-sinkable.3F"><h3>sinkable?</h3><div class="usage"><code>(sinkable? x)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L51">view source</a></div></div><div class="public anchor" id="var-source-only"><h3>source-only</h3><div class="usage"><code>(source-only s)</code></div><div class="doc"><div class="markdown"><p>Returns a view of the stream which is only a source.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L143">view source</a></div></div><div class="public anchor" id="var-source.3F"><h3>source?</h3><div class="usage"><code>(source? x)</code></div><div class="doc"><div class="markdown"><p>Returns true if the object is a Manifold source.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L166">view source</a></div></div><div class="public anchor" id="var-sourceable.3F"><h3>sourceable?</h3><div class="usage"><code>(sourceable? x)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L57">view source</a></div></div><div class="public anchor" id="var-splice"><h3>splice</h3><div class="usage"><code>(splice sink source)</code></div><div class="doc"><div class="markdown"><p>Splices together two halves of a stream, such that all messages enqueued via <code>put!</code> go into <code>sink</code>, and all messages dequeued via <code>take!</code> come from <code>source</code>.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L424">view source</a></div></div><div class="public anchor" id="var-stream"><h3>stream</h3><div class="usage"><code>(stream)</code><code>(stream buffer-size)</code><code>(stream buffer-size xform)</code><code>(stream buffer-size xform executor)</code></div><div class="doc"><div class="markdown"><p>Returns a Manifold stream with a configurable <code>buffer-size</code>. If a capacity is specified, <code>put!</code> will yield <code>true</code> when the message is in the buffer. Otherwise it will only yield <code>true</code> once it has been consumed.</p><p><code>xform</code> is an optional transducer, which will transform all messages that are enqueued via <code>put!</code> before they are dequeued via <code>take!</code>.</p><p><code>executor</code>, if defined, specifies which java.util.concurrent.Executor will be used to handle the deferreds returned by <code>put!</code> and <code>take!</code>.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L335">view source</a></div></div><div class="public anchor" id="var-stream*"><h3>stream*</h3><div class="usage"><code>(stream* {:keys [permanent? buffer-size description executor xform]})</code></div><div class="doc"><div class="markdown"><p>An alternate way to build a stream, via a map of parameters.</p>
<table>
  <tbody>
    <tr>
      <td align="left"><code>permanent?</code> </td>
      <td align="left">if <code>true</code>, the channel cannot be closed</td>
    </tr>
    <tr>
      <td align="left"><code>buffer-size</code> </td>
      <td align="left">the number of messages that can accumulate in the channel before backpressure is applied</td>
    </tr>
    <tr>
      <td align="left"><code>description</code> </td>
      <td align="left">the description of the channel, which is a single arg function that takes the base properties and returns an enriched map.</td>
    </tr>
    <tr>
      <td align="left"><code>executor</code> </td>
      <td align="left">the <code>java.util.concurrent.Executor</code> that will execute all callbacks registered on the deferreds returns by <code>put!</code> and <code>take!</code></td>
    </tr>
    <tr>
      <td align="left"><code>xform</code> </td>
      <td align="left">a transducer which will transform all messages that are enqueued via <code>put!</code> before they are dequeued via <code>take!</code>.</td>
    </tr>
  </tbody>
</table></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L354">view source</a></div></div><div class="public anchor" id="var-stream-.3Eseq"><h3>stream-&gt;seq</h3><div class="usage"><code>(stream-&gt;seq s)</code><code>(stream-&gt;seq s timeout-interval)</code></div><div class="doc"><div class="markdown"><p>Transforms a stream into a lazy sequence. If a <code>timeout-interval</code> is defined, the sequence will terminate if <code>timeout-interval</code> milliseconds elapses without a new event.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L512">view source</a></div></div><div class="public anchor" id="var-stream.3F"><h3>stream?</h3><div class="usage"><code>(stream? x)</code></div><div class="doc"><div class="markdown"><p>Returns true if the object is a Manifold stream.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L161">view source</a></div></div><div class="public anchor" id="var-synchronous.3F"><h3>synchronous?</h3><div class="usage"><code>(synchronous? x)</code></div><div class="doc"><div class="markdown"><p>Returns true if the underlying abstraction behaves synchronously, using thread blocking to provide backpressure.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L193">view source</a></div></div><div class="public anchor" id="var-take.21"><h3>take!</h3><div class="usage"><code>(take! source)</code><code>(take! source default-val)</code></div><div class="doc"><div class="markdown"><p>Takes a value from a stream, returning a deferred that yields the value when it is available, or <code>nil</code> if the take fails. Guaranteed to be non-blocking.</p><p>A special <code>default-val</code> may be specified, if it is important to differentiate between actual <code>nil</code> values and failures.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L263">view source</a></div></div><div class="public anchor" id="var-throttle"><h3>throttle</h3><div class="usage"><code>(throttle max-rate s)</code><code>(throttle max-rate max-backlog s)</code></div><div class="doc"><div class="markdown"><p>Limits the <code>max-rate</code> that messages are emitted, per second.</p><p>The <code>max-backlog</code> dictates how much &ldquo;memory&rdquo; the throttling mechanism has, or how many messages it will emit immediately after a long interval without any messages. By default, this is set to one second&rsquo;s worth.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L998">view source</a></div></div><div class="public anchor" id="var-transform"><h3>transform</h3><div class="usage"><code>(transform xform s)</code><code>(transform xform buffer-size s)</code></div><div class="doc"><div class="markdown"><p>Takes a transducer <code>xform</code> and returns a source which applies it to source <code>s</code>. A buffer-size may optionally be defined for the output source.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L564">view source</a></div></div><div class="public anchor" id="var-try-put.21"><h3>try-put!</h3><div class="usage"><code>(try-put! sink x timeout)</code><code>(try-put! sink x timeout timeout-val)</code></div><div class="doc"><div class="markdown"><p>Puts a value into a stream if the put can successfully be completed in <code>timeout</code> milliseconds. Returns a promiise that yields <code>true</code> if it succeeds, and <code>false</code> if it fails or times out. Guaranteed to be non-blocking.</p><p>A special <code>timeout-val</code> may be specified, if it is important to differentiate between failure due to timeout and other failures.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L246">view source</a></div></div><div class="public anchor" id="var-try-take.21"><h3>try-take!</h3><div class="usage"><code>(try-take! source timeout)</code><code>(try-take! source default-val timeout timeout-val)</code></div><div class="doc"><div class="markdown"><p>Takes a value from a stream, returning a deferred that yields the value if it is available within <code>timeout</code> milliseconds, or <code>nil</code> if it fails or times out. Guaranteed to be non-blocking.</p><p>Special <code>timeout-val</code> and <code>default-val</code> values may be specified, if it is important to differentiate between actual <code>nil</code> values and failures.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L279">view source</a></div></div><div class="public anchor" id="var-weak-handle"><h3>weak-handle</h3><div class="usage"><code>(weak-handle x)</code></div><div class="doc"><div class="markdown"><p>Returns a weak reference that can be used to construct topologies of streams.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L188">view source</a></div></div><div class="public anchor" id="var-zip"><h3>zip</h3><div class="usage"><code>(zip a)</code><code>(zip a &amp; rest)</code></div><div class="doc"><div class="markdown"><p>Takes n-many streams, and returns a single stream which will emit n-tuples representing a message from each stream.</p></div></div><div class="src-link"><a href="https://github.com/ztellman/manifold/blob/master/src/manifold/stream.clj#L605">view source</a></div></div></div></body></html>