<html lang="en">
  <head>
    <title>manifold.stream documentation</title>
    <link href="css/default.css" type="text/css" rel="stylesheet" />
    <link href="css/codox-md.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/page_effects.js"></script>
  </head>
  <body>
    <header>
      <div id="header">
        <h1 class="project-title">Manifold 0.1.0-beta1 API documentation</h1>
      </div>
    </header>
    <navigation>
      <div id="namespaces" class="sidebar">
        <h3>Namespaces</h3>
        <ul class="ns-links">
          <li class="ns-list"><a class="ns-link ns-name" href="manifold.bus.html">manifold.bus</a></li><li class="ns-list"><a class="ns-link ns-name" href="manifold.deferred.html">manifold.deferred</a></li><li class="ns-list"><a class="ns-link ns-name" href="manifold.stream.html">manifold.stream</a></li><li class="ns-list"><a class="ns-link ns-name" href="manifold.time.html">manifold.time</a></li>
        </ul>
      </div>
      <div id="vars" class="sidebar">
        <h3>Public Vars</h3>
        <ul class="ns-var-links">
          <li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var--%3Esink">-&gt;sink</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var--%3Esource">-&gt;source</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-batch">batch</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-buffer">buffer</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-buffered-stream">buffered-stream</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-close%21">close!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-closed%3F">closed?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-concat">concat</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-connect">connect</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-connect-via">connect-via</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-consume">consume</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-description">description</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-downstream">downstream</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-drained%3F">drained?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-filter">filter</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-map">map</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-mapcat">mapcat</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-on-closed">on-closed</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-on-drained">on-drained</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-partition-by">partition-by</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-periodically">periodically</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-put%21">put!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-put-all%21">put-all!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-reduce">reduce</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-reductions">reductions</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-sink-only">sink-only</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-sink%3F">sink?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-source-only">source-only</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-source%3F">source?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-splice">splice</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-stream">stream</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-stream-%3Eseq">stream-&gt;seq</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-stream%3F">stream?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-synchronous%3F">synchronous?</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-take%21">take!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-try-put%21">try-put!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-try-take%21">try-take!</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-weak-handle">weak-handle</a></li><li class="ns-var-list"><a class="ns-var-link ns-var-name" href="manifold.stream.html#var-zip">zip</a></li>
        </ul>
      </div>
    </navigation>
    <article>
      <div id="content" class="namespace-docs">
        <h2 class="namespace-title">manifold.stream documentation</h2>
        <div class="doc">
</div>
        <div class="ns-vars">
          <div class="public">
            <h3><a id="var--%3Esink" class="source var-name" href="/src/manifold/stream.clj">-&gt;sink</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div><div class="usage">[x default-val]</div>
            
            
            <div class="doc"><p>Converts, if possible, the object to a Manifold sink, or <code>default-val</code> if it cannot.  If no
default value is given, an <code>IllegalArgumentException</code> is thrown.</p>
</div>
          </div><div class="public">
            <h3><a id="var--%3Esource" class="source var-name" href="/src/manifold/stream.clj">-&gt;source</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div><div class="usage">[x default-val]</div>
            
            
            <div class="doc"><p>Converts, if possible, the object to a Manifold sink, or <code>default-val</code> if it cannot.  If no
default value is given, an <code>IllegalArgumentException</code> is thrown.</p>
</div>
          </div><div class="public">
            <h3><a id="var-batch" class="source var-name" href="/src/manifold/stream.clj">batch</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[batch-size s]</div><div class="usage">[max-latency max-size s]</div>
            
            
            <div class="doc"><p>Batches messages, either into groups of fixed size, or according to upper bounds on size and
latency, in milliseconds.</p>
</div>
          </div><div class="public">
            <h3><a id="var-buffer" class="source var-name" href="/src/manifold/stream.clj">buffer</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[limit s]</div><div class="usage">[metric limit s]</div>
            
            
            <div class="doc"><p>Takes a stream, and returns a stream which is a buffered view of that stream.  The buffer
size may either be measured in messages, or if a <code>metric</code> is defined, by the sum of <code>metric</code>
mapped over all messages currently buffered.</p>
</div>
          </div><div class="public">
            <h3><a id="var-buffered-stream" class="source var-name" href="/src/manifold/stream.clj">buffered-stream</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[buffer-size]</div><div class="usage">[metric limit]</div><div class="usage">[metric limit description]</div>
            
            
            <div class="doc"><p>A stream which will buffer at most <code>limit</code> data, where the size of each message
is defined by <code>(metric message)</code>.</p>
</div>
          </div><div class="public">
            <h3><a id="var-close%21" class="source var-name" href="/src/manifold/stream.clj">close!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink]</div>
            
            
            <div class="doc"><p>Closes an event sink, so that it can't accept any more messages.</p>
</div>
          </div><div class="public">
            <h3><a id="var-closed%3F" class="source var-name" href="/src/manifold/stream.clj">closed?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink]</div>
            
            
            <div class="doc"><p>Returns true if the event sink is closed.</p>
</div>
          </div><div class="public">
            <h3><a id="var-concat" class="source var-name" href="/src/manifold/stream.clj">concat</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[s]</div>
            
            
            <div class="doc"><p>Takes a stream of streams, and flattens it into a single stream.</p>
</div>
          </div><div class="public">
            <h3><a id="var-connect" class="source var-name" href="/src/manifold/stream.clj">connect</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[source sink]</div><div class="usage">[source sink {:keys [upstream? downstream? timeout description], :or {upstream? false, downstream? true}}]</div>
            
            
            <div class="doc"><p>Connects a source to a sink, propagating all messages from the former into the latter.</p>

<p>Optionally takes a map of parameters, which include:</p>

<p><code>upstream?</code> - if closing the sink should always close the source, even if there are other
sinks downstream of the source.  Defaults to <code>false</code>.  Note that if the sink is the only
thing downstream of the source, the source will always be closed, unless it is permanent.</p>

<p><code>downstream?</code> - if closing the source will close the sink.  Defaults to <code>true</code>.</p>

<p><code>timeout</code> - if defined, the maximum time, in milliseconds, that will be spent trying to
 put a message into the sink before closing it.  Useful when there are multiple sinks
 downstream of a source, and you want to avoid a single backed up sink from blocking
 all the others.</p>

<p> <code>description</code> - describes the connection, useful for traversing the stream topology via
 <code>downstream</code>.</p>
</div>
          </div><div class="public">
            <h3><a id="var-connect-via" class="source var-name" href="/src/manifold/stream.clj">connect-via</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[src callback dst]</div><div class="usage">[src callback dst options]</div>
            
            
            <div class="doc"><p>Feeds all messages from <code>src</code> into <code>callback</code>, with the understanding that they will eventually
be propagated into <code>dst</code> in some form.</p>
</div>
          </div><div class="public">
            <h3><a id="var-consume" class="source var-name" href="/src/manifold/stream.clj">consume</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[callback source]</div>
            
            
            <div class="doc"><p>Feeds all messages from <code>source</code> into <code>callback</code>.</p>
</div>
          </div><div class="public">
            <h3><a id="var-description" class="source var-name" href="/src/manifold/stream.clj">description</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns a description of the stream.</p>
</div>
          </div><div class="public">
            <h3><a id="var-downstream" class="source var-name" href="/src/manifold/stream.clj">downstream</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns all sinks downstream of the given source as a sequence of 2-tuples, with the
first element containing the connection's description, and the second element containing
the sink.</p>
</div>
          </div><div class="public">
            <h3><a id="var-drained%3F" class="source var-name" href="/src/manifold/stream.clj">drained?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[source]</div>
            
            
            <div class="doc"><p>Returns true if the event source is drained.</p>
</div>
          </div><div class="public">
            <h3><a id="var-filter" class="source var-name" href="/src/manifold/stream.clj">filter</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[pred s]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>filter</code>, but for streams instead of sequences.</p>
</div>
          </div><div class="public">
            <h3><a id="var-map" class="source var-name" href="/src/manifold/stream.clj">map</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[f s]</div><div class="usage">[f s &amp; rest]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>map</code>, but for streams instead of sequences.</p>
</div>
          </div><div class="public">
            <h3><a id="var-mapcat" class="source var-name" href="/src/manifold/stream.clj">mapcat</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[f s]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>mapcat</code>, but for streams instead of sequences.</p>
</div>
          </div><div class="public">
            <h3><a id="var-on-closed" class="source var-name" href="/src/manifold/stream.clj">on-closed</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink callback]</div>
            
            
            <div class="doc"><p>Registers a no-arg callback which is invoked when the sink is closed.</p>
</div>
          </div><div class="public">
            <h3><a id="var-on-drained" class="source var-name" href="/src/manifold/stream.clj">on-drained</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[source callback]</div>
            
            
            <div class="doc"><p>Registers a no-arg callback which is invoked when the source is drained.</p>
</div>
          </div><div class="public">
            <h3><a id="var-partition-by" class="source var-name" href="/src/manifold/stream.clj">partition-by</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[f s]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>partition-by</code>, but returns a stream of streams.</p>
</div>
          </div><div class="public">
            <h3><a id="var-periodically" class="source var-name" href="/src/manifold/stream.clj">periodically</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[period initial-delay f]</div><div class="usage">[period f]</div>
            
            
            <div class="doc"><p>Creates a stream which emits the result of invoking <code>(f)</code> every <code>period</code> milliseconds.</p>
</div>
          </div><div class="public">
            <h3><a id="var-put%21" class="source var-name" href="/src/manifold/stream.clj">put!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink x]</div>
            
            
            <div class="doc"><p>Puts a value into a sink, returning a deferred that yields <code>true</code> if it succeeds,
and <code>false</code> if it fails.  Guaranteed to be non-blocking.</p>
</div>
          </div><div class="public">
            <h3><a id="var-put-all%21" class="source var-name" href="/src/manifold/stream.clj">put-all!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink msgs]</div>
            
            
            <div class="doc"><p>Puts all values into the sink, returning a deferred that yields <code>true</code> if all puts
are successful, or <code>false</code> otherwise.  Guaranteed to be non-blocking.</p>
</div>
          </div><div class="public">
            <h3><a id="var-reduce" class="source var-name" href="/src/manifold/stream.clj">reduce</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[f s]</div><div class="usage">[f initial-value s]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>reductions</code>, but for streams instead of sequences.</p>
</div>
          </div><div class="public">
            <h3><a id="var-reductions" class="source var-name" href="/src/manifold/stream.clj">reductions</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[f s]</div><div class="usage">[f initial-value s]</div>
            
            
            <div class="doc"><p>Equivalent to Clojure's <code>reductions</code>, but for streams instead of sequences.</p>
</div>
          </div><div class="public">
            <h3><a id="var-sink-only" class="source var-name" href="/src/manifold/stream.clj">sink-only</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[s]</div>
            
            
            <div class="doc"><p>Returns a view of the stream which is only a sink.</p>
</div>
          </div><div class="public">
            <h3><a id="var-sink%3F" class="source var-name" href="/src/manifold/stream.clj">sink?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns true if the object is a Manifold source</p>
</div>
          </div><div class="public">
            <h3><a id="var-source-only" class="source var-name" href="/src/manifold/stream.clj">source-only</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[s]</div>
            
            
            <div class="doc"><p>Returns a view of the stream which is only a source.</p>
</div>
          </div><div class="public">
            <h3><a id="var-source%3F" class="source var-name" href="/src/manifold/stream.clj">source?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns true if the object is a Manifold source</p>
</div>
          </div><div class="public">
            <h3><a id="var-splice" class="source var-name" href="/src/manifold/stream.clj">splice</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink source]</div>
            
            
            <div class="doc"><p>Slices together two halves of a stream.</p>
</div>
          </div><div class="public">
            <h3><a id="var-stream" class="source var-name" href="/src/manifold/stream.clj">stream</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[]</div><div class="usage">[buffer-size]</div>
            
            
            <div class="doc"><p>Returns a Manifold stream with a configurable <code>buffer-size</code>.  If a capacity is specified,
<code>put!</code> will yield <code>true</code> when the message is in the buffer.  Otherwise it will only yield
<code>true</code> once it has been consumed.</p>
</div>
          </div><div class="public">
            <h3><a id="var-stream-%3Eseq" class="source var-name" href="/src/manifold/stream.clj">stream-&gt;seq</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[s]</div><div class="usage">[s timeout-interval]</div>
            
            
            <div class="doc"><p>Transforms a stream into a lazy sequence.  If a <code>timeout-interval</code> is defined, the sequence will terminate
if <code>timeout-interval</code> milliseconds elapses without a new event.</p>
</div>
          </div><div class="public">
            <h3><a id="var-stream%3F" class="source var-name" href="/src/manifold/stream.clj">stream?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns true if the object is a Manifold stream.</p>
</div>
          </div><div class="public">
            <h3><a id="var-synchronous%3F" class="source var-name" href="/src/manifold/stream.clj">synchronous?</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns true if the underlying abstraction behaves synchronously, using thread blocking
to provide backpressure.</p>
</div>
          </div><div class="public">
            <h3><a id="var-take%21" class="source var-name" href="/src/manifold/stream.clj">take!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[source]</div><div class="usage">[source default-val]</div>
            
            
            <div class="doc"><p>Takes a value from a stream, returning a deferred that yields the value when it
is available, or <code>nil</code> if the take fails.  Guaranteed to be non-blocking.</p>

<p>A special <code>default-val</code> may be specified, if it is important to differentiate
between actual <code>nil</code> values and failures.</p>
</div>
          </div><div class="public">
            <h3><a id="var-try-put%21" class="source var-name" href="/src/manifold/stream.clj">try-put!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[sink x timeout]</div><div class="usage">[sink x timeout timeout-val]</div>
            
            
            <div class="doc"><p>Puts a value into a stream if the put can successfully be completed in <code>timeout</code>
milliseconds.  Returns a promiise that yields <code>true</code> if it succeeds, and <code>false</code>
if it fails or times out.  Guaranteed to be non-blocking.</p>

<p>A special <code>timeout-val</code> may be specified, if it is important to differentiate
between failure due to timeout and other failures.</p>
</div>
          </div><div class="public">
            <h3><a id="var-try-take%21" class="source var-name" href="/src/manifold/stream.clj">try-take!</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[source timeout]</div><div class="usage">[source default-val timeout timeout-val]</div>
            
            
            <div class="doc"><p>Takes a value from a stream, returning a deferred that yields the value if it is
available within <code>timeout</code> milliseconds, or <code>nil</code> if it fails or times out.
Guaranteed to be non-blocking.</p>

<p>Special <code>timeout-val</code> and <code>default-val</code> values may be specified, if it is
important to differentiate between actual <code>nil</code> values and failures.</p>
</div>
          </div><div class="public">
            <h3><a id="var-weak-handle" class="source var-name" href="/src/manifold/stream.clj">weak-handle</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[x]</div>
            
            
            <div class="doc"><p>Returns a weak reference that can be used to construct topologies of streams.</p>
</div>
          </div><div class="public">
            <h3><a id="var-zip" class="source var-name" href="/src/manifold/stream.clj">zip</a></h3>
            <h4 class="var-type fn" id="var-type">fn</h4>
            <div class="usage">[a]</div><div class="usage">[a &amp; rest]</div>
            
            
            <div class="doc"><p>Takes n-many streams, and returns a single stream which will emit n-tuples representing
a message from each stream.</p>
</div>
          </div>
        </div>
      </div>
    </article>
  </body>

</html>